
test {
    useJUnitPlatform()
}

task unitTests( type: Test, dependsOn: [build] ) {
    description = 'Runs the Unit Tests.'
    useJUnitPlatform {
        scanForTestClasses = false
        includes = ['**/*UnitTest.class']
        excludes = ['**/BaseUnitTest.class']
        maxParallelForks = Runtime.runtime.availableProcessors()
    }
    testLogging {
        showStandardStreams = false
        exceptionFormat = 'full'
    }
    reports.html.destination( file( "$buildDir/reports/unitTests" ) )
}

task integrationTests( type: Test, dependsOn: [build] ) {
    description = 'Runs the Integration Tests.'
    debug = false
    useJUnitPlatform {
        scanForTestClasses = false
        includes = ['**/*IntegrationTest.class']
        excludes = ['']
    }
    testLogging {
        showStandardStreams = false
        exceptionFormat = 'full'
    }
    reports.html.destination( file( "$buildDir/reports/outboundIntegrationTests" ) )

    // if the profile system property is set, copy into forked child process
    def springProfilesActive = System.properties['spring.profiles.active']
    if ( springProfilesActive ) { systemProperties['spring.profiles.active'] = springProfilesActive }
}
